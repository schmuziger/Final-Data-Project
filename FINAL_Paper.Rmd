---
title: "Youth unemployment and turnout in Spain"
author: "Rafael Goldzweig & Rita Alvarez"
date: "December 2, 2016"
output:
  pdf_document:
    number_sections: yes
    toc: yes
bibliography: References_final.bib
nocite: | 
  @burden2012unemployment, @anduiza2014mobilization
---

```{r options, include=FALSE, echo=FALSE}
knitr::opts_chunk$set(message = FALSE)
# opts_chunk$set(tidy=FALSE)
# opts_chunk$set(fig.path='figs/', cache.path='cache/graphics-', 
#         fig.align='center', fig.width = 5, fig.height = 5, fig.show = 'hold',
#         cache = TRUE, par = TRUE)
```

```{r library, message=FALSE, echo=FALSE, include=FALSE}
library(pxR)
library(MicroDatosEs)
library(XML)
library(zoo)
library(rvest)
library(dplyr)
library(magrittr)
library(foreign)
library(readxl)
#library(xlsx)
library(ggplot2)
library(pastecs)
library(stargazer)
library(gplots)
```

```{r setup, message=FALSE, echo=FALSE, include=FALSE}
# Clear Global environment
rm(list=ls())

# set WD
#setwd('C:/Users/Rita/Desktop/Final Data Project')
```

```{r turnout data, results='asis', tidy=TRUE, echo=FALSE}
# Read Turnout data

Turnout2004_2008_2011_2015 <- read_excel("C:/Users/Rita/Desktop/Assignment-3/ElectionsResult_2015_2011_2008_2004.xlsx", col_names = TRUE)
```

```{r unemployment data, results='asis', tidy=TRUE, echo=FALSE}
# Read Unemployment data

YouthUnemployment2004_2015 <- read_excel("C:/Users/Rita/Desktop/Assignment-3/YouthUnemployment2015_2011_2008_2004.xlsx", col_names = TRUE)
```

```{r controls, results='asis', tidy=TRUE, echo=FALSE}
# Read control variables data

Controlvariables <- read_excel("C:/Users/Rita/Desktop/Assignment-3/Controlvariables.xlsx", col_names = TRUE)

```

```{r dataset1, results='asis', tidy=TRUE, echo=FALSE}
# Merge the dataset of electoral results with the dataset of unemployment rates. Change columns as numeric and clean one column

Spain_data_1 <- merge(Turnout2004_2008_2011_2015, YouthUnemployment2004_2015, by=c("Region","Year"), all=TRUE)
```

```{r dataset2, results='asis', tidy=TRUE, echo=FALSE}
# Merge the dataset of electoral results with the dataset of controls

Spain_data <- merge(Spain_data_1, Controlvariables, by=c("Region","Year"), all=TRUE)
```

```{r adjustments, results='asis', tidy=TRUE, echo=FALSE}
#Final adjustments.  Change columns as numeric and clean one column

Spain_data$Unempl_rate_total<- as.numeric(Spain_data$Unempl_rate_total)
Spain_data$Unempl_rate_less25 <- as.numeric(Spain_data$Unempl_rate_less25)
Spain_data$Unempl_rate_16_19 <- as.numeric(Spain_data$Unempl_rate_16_19)
Spain_data$Unempl_rate_20_24 <- as.numeric(Spain_data$Unempl_rate_20_24)

Spain_data <- Spain_data[, -c(7,7)]
```

```{r dataset, results='asis', tidy=TRUE, echo=FALSE}

# Create region code

Spain_data$Region_code <- ifelse(Spain_data$Region == 'Extremadura', 'EX', ifelse(Spain_data$Region == 'Castilla_La_Mancha', 'CM', ifelse(Spain_data$Region == 'Murcia', 'MU', ifelse(Spain_data$Region == 'Canarias', 'IC', ifelse(Spain_data$Region == 'Galicia', 'GA', ifelse(Spain_data$Region == 'Comunitat_Valenciana', 'CV', ifelse(Spain_data$Region == 'Melilla', 'ME', ifelse(Spain_data$Region == 'Asturias', 'AS', ifelse(Spain_data$Region == 'Ceuta', 'CE', ifelse(Spain_data$Region == 'Castilla_y_Leon', 'CL', ifelse(Spain_data$Region == 'Andalucia', 'AN', ifelse(Spain_data$Region == 'Cantabria', 'CA', ifelse(Spain_data$Region == 'Baleares', 'IB', ifelse(Spain_data$Region == 'Aragon', 'AR', ifelse(Spain_data$Region == 'Catalunya', 'CT', ifelse(Spain_data$Region == 'Madrid', 'MA', ifelse(Spain_data$Region == 'Navarra', 'NV', ifelse(Spain_data$Region == 'Pais_Vasco', 'PV', ifelse(Spain_data$Region == 'La_Rioja', 'LR', NA)))))))))))))))))))

region_code <- c("AN", "AR", "AS", "IB", "IC", "CA", "CM", "CL", "CT", "CE", "CV", "EX", "GA", "LR", "MA", "ME", "MU", "NV", "PV")

region_name <- c("Andalucia", "Aragon", "Asturias", "Baleares", "Canarias", "Cantabria", "Castilla_La_Mancha", "Castilla_y_Leon", "Catalunya", "Ceuta", "Comunitat_Valenciana", "Extremadura", "Galicia", "La_Rioja", "Madrid", "Melilla", "Murcia", "Navarra", "Pais_Vasco")
```

```{r fix, results='asis', tidy=TRUE, echo=FALSE}
# Create one dummy for each year
Spain_data["four"] <- as.numeric(Spain_data$Year == 2004)
Spain_data["eight"] <- as.numeric(Spain_data$Year == 2008)
Spain_data["eleven"] <- as.numeric(Spain_data$Year == 2011)
Spain_data["fifteen"] <- as.numeric(Spain_data$Year == 2015)
```

```{r exp, results='asis', tidy=TRUE, echo=FALSE}
# Exporting data
write.csv(Spain_data, "spain_data.csv", row.names=F)
```

# INTRODUCTION AND RESEARCH QUESTION

Voter turnout is the most common measurement of participation in a democracy. Many authors have studied what are the determinants of voter turnout (see @Geys2006637 for a comprehensive summary of the recent literature on voter turnout). Among the determinants of tunout we can find age, race/ethnicity, gender, socio-economic status and political/economical situation of the country. In this broad spectrum of variables that influence participation of voters in elections, this article will focus specifically on whether youth unemployment (unemployment of people ranging between 16 and 24 years old) has an impact on turnout in the case of Spain. Youth unemployment has been a pressing issue in the country in the period of 2000-2016, when the rates were not lower than 17.5\% throughout the whole period and a maximum of 55\% was achieved in the first months of 2014 (Source: Eurostat).

We are also interested to see if youth unemployment mobilize voters with more intensity in regions where the rate of young people is higher. If this is the case, this effect can be explained by three different sources: because older people feel the resposability to vote more given the amount of young people unemployed, because young people go to vote more or because of a combination of the two factors above.

We consider this study is very interesting in the light of the recent changes in the political system of the country. Spain went from a party system traditionally dominated by the \textit{PP} (center-right) and the \textit{PSOE} (center-left) to a multy party system where the \textit{Podemos} (left) and \textit{Ciudadanos} (liberal/center-right) reached the national parliament with a significant vote share for the first time in the recent national elections of 2015. \textit{Ciudadanos} is a party that was only present in the Catalan political life at its foundation. In 2008 they run in the general elections for the first time. \textit{Podemos} was founded in 2014 and run in the general elections for the first time in 2015.  Our \textbf{hypothesis} is that given the high youth unemployment rates, young people would involve more in the political life. Also, as the new parties appleal more to young voters this could cause the change in the party system.

# LITERATURE REVIEW

Literature on voter behavior tend to rely mainly on the incumbency-oriented hypothesis, which claims that voters tend to reward or punish government in elections according to the economic performance of the country @norpoth1996presidents. In that sense, objective or subjective economic indicators such as unemployment rates, inflation, growth and other related aspects have the potential to explain part of the variance in government support @lewis2000economic.  

Citizen dissatisfaction with economic performance substantially increases the possibility to vote against the incumbent. While some authors believe that the state of employment does not have a detectable effect upon voting behavior @stigler1973genera others have reasons to believe that unemployment rates play a role depending on the political identification of the incumbent party, with left-wing governments suffering more from hign unemployment rates than right-wing governments @dassonneville2013economic. In that view, unemployment can alter voter behavior of already mobilized voters, but not mobilize additional people that are not politically active.

While many studies focus on this incumbency oriented approach, there is surprinsingly little research investigating exactly through which channels the economic aspects influences voter participation. Contrary to the general consensus emerging from existing research, some authors show that higher levels of unemployment stimulate more people to vote @burden2012unemployment. This research using the U.S. case shows that the turnout gap between the employed and unemployed shrinks as state unemployment increases, suggesting that unemployment statistics invigorates rather than suppress electoral participation.

In that sense, individuals perceive job loss as a personal problem when the unemployment rate is low and a social problem when the unemployment rate is high. Therefore, job loss can be a mobilizing experience when the unemployment rate is high. In particular, "unemployed Americans' political behavior is meaningfully influenced by unemployment context to an extent that we do not observe among gainfully employed Americans" @incantalupo2011effects. This finding is particularly interesting in the context of our research. Although our study focuses on the Spanish case, we do not expect this kind of behavior to be completely different than the U.S case and this could mean that young unemployed people, in a high unemployment context, would show higher turnout in the election day affecting the political outcome. 

Data from the Spanish Center of Sociological Research collected before the general elections in the Spring of 2011, shows that 40.6\% of the Spanish young people (15 to 29 years old) felt distrust regarding politics. It is relevant to mention that a few weeks after the general election occured in 2011, the 15-M movement (March 15 movement) started. This movement was  a response to the inability of institutional politics to deal with the problems the country had been facing since 2009 and that speed up the appearance of new political parties into the National scene such as \textit{Podemos} or \textit{Ciudadanos}. 

@anduiza2014mobilization point out a very interesting fact. They compared the profile of the 15-M protesters with the participants of other four major demonstrations happening in Spain during the crisis. They found that, while the four demonstrations had participants with high levels or membership to traditional organizations (between 60% and 100%) and organizations behind the demonstrations ranging from 10 to 43 years of existence, only 13% of the 15-M demonstrators were affiliated to any type of organization. Also, the organizations participating on the 15-M movements had less than 3 years of existence. The main argument is that the 15-M movements have the potential to mobilize a different profile of participants - in many cases, people traditionally less likely to have a big political participation. 

The party that benefitted the most out of this change was \textit{Podemos}. The party was founded in March 2014 by a manifesto broadcasted by Publico, an online Spanish newspaper, in the aftermath of the 15-M movement. With a left wing populist approach, it aimed to address the problems of inequality, unemployment and economic consequences of the European debt crisis. Soon after its creation, Podemos became the second largest political party in Spain by number of members after the People's Party (\textit{PP}) and received 21\% of the vote in the elections for the national parliament on December 2015, becoming the third largest party in the parliament in less than two years of existence. 

In this context, @jover2014political argues that the previous distrust feeling would make young Spanish voters to not to participate in the general elections of 2011. Hence, after the 15-M and with the appearance of new political options, the youth would mobilize and vote more in subsequent elections. In fact, 41.8\% of the young people answered in a survey that the 15-M movement had influenced them a lot to cast their vote in the regional elections in the Fall of 2011, months after the general elections. It is important to mention that @jover2014political shows data from self-reported surveys and does not prove causality between youth unemployment and turnout or between the appearance of new political parties and turnout. 

In this framework, our study aims to build upon the research of economic variables affecting turnout, especially through the channel of unemployment. Without focusing directly on the change of preferences that traditionally is taken into account to analyze voter behavior, we want to see if socio-economic reasons have the potential to affect general turnout rates through the mobilization of groups traditionally not very politically active. 

# DATA 

\textbf{Dependent variable}

Our dependent variable is voter turnout in the Spanish general elections of 

Our model will be tested using data from the Spanish Statistic Office (INE), the Electoral Results from the Spanish Ministry of Interior Affairs (MI), Eurostat and Expansion in the different regions of the country.

The electoral data results from 2008 and 2011 came from the same source (Spain Public Administration), while the 2015 and 2004 (media) from one source each. All of them report the results from the elections according to the Spanish Ministry of Interior Affairs. We made use of a web-scrappable interface from the websites of our sources to import the results to build our dataset. For each of the 19 regions of Spain, we used a differet URL source to grab the data available online. This process was done simmilarly with the data from 2008, 2011 and 2015. We could not find any source online that provided a web scraping friendly version from the data of 2004, and we decided to create an excel file with it. 

The unemployment rates by age data comes from the Spanish National Statistics Institute (INE). The data is available by trimester for every year and every region. We imported the data directly from the website and transformed the database to fit the ones containing the electoral results. 

We also collected data from Eurostat on the percentage of university graduates per region and data from Expansion on the GDP per capita and GDP growth per region. 

We used web scraping as well as downloading the datasets directly from the sources and then we merged using Region and Year as our common variables to form the final dataset "Spain_data".


# STATISTICAL MODEL AND HYPOTHESIS

Our theory is that turnout is positively impacted by higher youth unemployment rates. In order to analyze this relation statistically we use voter turnout as our main dependent variable and youth unemployment rate as our main independent variable. We also control 

for differences among the distinct regions in Spain, we propose the following model:

$Turnout_{i,t}=\beta_0+\beta_1 Youth\ Unemployment_{i,t}+\beta_2 \% Annual\ GDP \ growth + \beta_3 \% Tertiary\ Education + \delta_i + \lambda_t +  u_{i,t}$

where $i$ represents each of the 19 regions of Spain, $t$ represent the most recent years where general elections where held: 2004, 2008, 2011 and 2015 and $\delta_i$ represents regional fixed effects. 


## Basic descriptive statistics

```{r 1, results='asis', tidy=TRUE, echo=FALSE, include=FALSE}
stat.desc(Spain_data) 
m <- stat.desc(Spain_data, basic=F)
m <- m[, -c(1:2)]
```


```{r stargazer, results='asis', tidy=TRUE, echo=FALSE, header = FALSE}
stargazer(m)
```

We are looking at tunout from general elections in Spain that occured in the years 2004, 2008, 2011 and 2015. The elections in 2015 did not result in the formation of government due to a highly fragmented parlament and the general elections were reperated in 2016. However, we decided to use only the data from the 2015 election since in a second call people might turn or not to turn to vote for different reasons than in normal elections.  The average turnout rate in Spain in these years (2004, 2008, 2011, 2015) was 72.02%. This is a pretty high turnout rate for a developed country that does not have compulsory voting. However, the differences across regions would be notable. Another thing to highlight from the table above is that invalid votes are in general more casted than blank votes.

When looking at unemployemnt rates it is clear that the average youth unemployment rate is much higher than the average total unemployment rate in years 2004, 2008, 2011 and 2015. Average youth unemployment rates increase drastically as the age of the populations groups studied lowers. Also, the standard deviation of the mean unemployment rate is higher for youth unemployemnt rate than for the normal unemployment rate indicating that youth unemployment varied more from year 2004 to year 2015.

##Turnout

```{r plot turnout, fig.width=8, fig.height=6, echo=FALSE}
ggplot(Spain_data, aes(x = Region, y = Turnout)) + geom_line()
```

The plot shows the variability of tunout by region in Spain. The regions that have lower turnout during the years 2004-2015 were Ceuta, Melilla, Baleares and Canarias. Ceuta and Melilla and autonomous cities that are phisically in Moroccan territory and Baleares and Canarias are islands. This gives the hint that people living in this regions might feel less attached to the Central government and therefore they vote less. It is also interesting to observe that the regions with a second official language different than Spanish, Catalunya, Galicia and Pais Vasco tend to have also lower turnout rates in the period.

##Unemployment

```{r plot unemployment, fig.width=8, fig.height=6, echo=FALSE}
ggplot(Spain_data, aes(x = Region, y = Unempl_rate_less25)) + geom_line()
```

Youth unemployment rates show a wide range during the period 2004-2015. Youth unemployment rates are structurally high in Spain. However, after the beginning of the economic crisis in 2008, youth unemployment rates explode. They went from around 20% in most regions to nearly 50%. However, Ceuta and Melilla stand out for their extremely high youth unemployment rates both before and after the economic crisis. The following graphs show that the youth unemployment rate is higher the lower is the age of the population studied.

```{r echo = FALSE, out.width=c('300px', '300px'), fig.show='hold'} 

```

```{r plot region 1, fig.width=8, fig.height=5, echo=FALSE, warning=FALSE}
# include map

region_code <- c("AN", "AR", "AS", "IB", "IC", "CA", "CM", "CL", "CT", "CE", "CV", "EX", "GA", "LR", "MA", "ME", "MU", "NV", "PV")

region_name <- c("Andalucia", "Aragon", "Asturias", "Baleares", "Canarias", "Cantabria", "Castilla_La_Mancha", "Castilla_y_Leon", "Catalunya", "Ceuta", "Comunitat_Valenciana", "Extremadura", "Galicia", "La_Rioja", "Madrid", "Melilla", "Murcia", "Navarra", "Pais_Vasco")

ggplot(data=Spain_data, aes(x=Year, y=Unempl_rate_20_24, group = Region, colour = Region)) + geom_line() + ggtitle("Youth Unemployment per region") + 
  labs(x="Year", y="Unemployment rate 20-24") + 
  ggtitle("Youth Unemployment per region 2004-2015") + 
  scale_color_discrete(labels = region_code) + 
  theme(legend.position = "bottom", legend.key = element_rect(size = 5, fill = 'white', colour = 'white'), legend.key.size = unit(2.0, 'lines'), axis.title.y=element_text(margin=margin(10,10,0,10)))
```


```{r plot region 2, fig.width=8, fig.height=5, echo=FALSE, warning=FALSE}

plotmeans(Turnout ~ Region_code, main="Heterogeineity across regions", data=Spain_data)

# include map
```

## Unemployment and turnout


```{r unemp turn, fig.width=8, fig.height=6, echo=FALSE, warning=FALSE}
plot(Spain_data$Unempl_rate_total, Spain_data$turnout)
```

```{r unemp turn 1, fig.width=8, fig.height=6, echo=FALSE, warning=FALSE}
# Add aesthetic mappings

p <- ggplot(Spain_data, aes(Unempl_rate_less25, Turnout))
p + geom_point()
p1<-p + geom_point(aes(colour = Region_code)) 
p3 <- p1 + labs(y="Turnout", x= "Youth Unemployment")
p5 <- p3 + scale_y_continuous("Turnout",
                              limits=c(0.4,0.85),
                              breaks=seq(0.4, 0.85, 0.2)) + stat_smooth(method = 'lm', aes(colour = Region_code), se = FALSE)
p5

p6<-p5 + theme(axis.text.x = element_blank())
p6
```


# ORIGINAL - COLORS PER REGION AND LINES
```{r unemp turn 5, fig.width=8, fig.height=6, echo=FALSE, warning=FALSE}
p <- ggplot(Spain_data, aes(Unempl_rate_less25, Turnout))
p + geom_point()
p1<-p + geom_point(aes(colour = Region)) 
p3 <- p1 + labs(y="Turnout", x= "Youth Unemployment")
p5 <- p3 + scale_y_continuous("Turnout",
                              limits=c(0.4,0.85),
                              breaks=seq(0.4, 0.85, 0.2)) + stat_smooth(method = 'lm', aes(colour = Region), se = FALSE)
p5

p6<-p5 + theme(axis.text.x = element_blank())
p6
```

This plot shows how tunout and youth unemploment rate could be correlated. The plot shows that the correlation is not clear. 

The graphs are not showing the potential correlation by region that may exist between unemployment and turnout, an information that could give us a different perspective on the issue. Therefore, we need to explore this dataset further in order to conclude which is the relationship between turnout and youth unemployment rate in Spain.

##Regressions

```{r p, results='asis', tidy=TRUE, echo=FALSE, header = FALSE}

Reg3 <- lm(Turnout ~ Unempl_rate_less25*GDPpc + Unempl_rate_less25 + GDPpc + PctUniversityGraduates + Region + , data = Spain_data)

ggplot(data = margins, aes(x = netenergy_imports, y = me, ymin = lwr, ymax = upr)) + geom_ribbon(fill = 'blue', alpha = 0.2) + geom_line(colour = "red", size =1) + theme_bw() + geom_hline(yintercept = 0, linetype = 'dashed') + xlab("\nEnergy Imports (% of consumption)") + ylab("Marginal Effect of Oil Price\n") + ggtitle("") + theme(panel.background = element_rect(fill = 'white', colour = 'black'))
stargazer(m)
```

##Bibliography